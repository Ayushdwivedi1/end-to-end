{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { NavigationEnd } from '@angular/router';\nimport { filter } from 'rxjs/operators';\nexport let AppComponent = class AppComponent {\n  constructor(authService, router, location) {\n    this.authService = authService;\n    this.router = router;\n    this.location = location;\n    this.title = 'AI Central';\n  }\n  ngOnInit() {\n    // Handle browser back/forward navigation\n    this.router.events.pipe(filter(event => event instanceof NavigationEnd)).subscribe(event => {\n      if (event instanceof NavigationEnd) {\n        this.handleNavigation(event);\n      }\n    });\n    // Handle browser back button specifically\n    this.location.onPopState(() => {\n      this.handleBrowserBack();\n    });\n  }\n  handleNavigation(event) {\n    const isLoggedIn = this.isLoggedIn();\n    const currentUrl = event.url;\n    // If user is not logged in and trying to access protected routes\n    if (!isLoggedIn && this.isProtectedRoute(currentUrl)) {\n      this.router.navigate(['']);\n      return;\n    }\n    // If user is logged in and on login page (root or /login), redirect to dashboard and replace history\n    if (isLoggedIn && (currentUrl === '/' || currentUrl === '/login')) {\n      this.router.navigate(['/dashboard'], {\n        replaceUrl: true\n      });\n      return;\n    }\n    // Clear any cached data if user is not logged in\n    if (!isLoggedIn) {\n      this.authService.clearUserData();\n    }\n  }\n  handleBrowserBack() {\n    const isLoggedIn = this.isLoggedIn();\n    const currentUrl = this.router.url;\n    // If user is logged in and trying to go back to login page, prevent it\n    if (isLoggedIn && (currentUrl === '/' || currentUrl === '/login')) {\n      // Replace the current history entry with dashboard\n      this.router.navigate(['/dashboard'], {\n        replaceUrl: true\n      });\n      return;\n    }\n    // If user is not logged in and trying to access protected routes, redirect to login\n    if (!isLoggedIn && this.isProtectedRoute(currentUrl)) {\n      this.router.navigate(['']);\n      return;\n    }\n  }\n  isProtectedRoute(url) {\n    const protectedRoutes = ['/dashboard', '/user-list', '/user-create', '/user-edit', '/user-view', '/profile', '/change-password'];\n    return protectedRoutes.some(route => url.startsWith(route));\n  }\n  isLoggedIn() {\n    return this.authService.isLoggedIn();\n  }\n  isOnLandingPage() {\n    return this.router.url === '/' || this.router.url === '/login';\n  }\n  logout() {\n    const userData = this.authService.getUserData();\n    if (userData) {\n      this.authService.logout(userData.username).subscribe({\n        next: () => {\n          this.authService.clearUserData();\n          this.router.navigate(['']);\n        },\n        error: () => {\n          this.authService.clearUserData();\n          this.router.navigate(['']);\n        }\n      });\n    } else {\n      this.authService.clearUserData();\n      this.router.navigate(['']);\n    }\n  }\n};\nAppComponent = __decorate([Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})], AppComponent);","map":{"version":3,"names":["Component","NavigationEnd","filter","AppComponent","constructor","authService","router","location","title","ngOnInit","events","pipe","event","subscribe","handleNavigation","onPopState","handleBrowserBack","isLoggedIn","currentUrl","url","isProtectedRoute","navigate","replaceUrl","clearUserData","protectedRoutes","some","route","startsWith","isOnLandingPage","logout","userData","getUserData","username","next","error","__decorate","selector","templateUrl","styleUrls"],"sources":["/Users/ent-00387/Documents/end-to-end/Ui/src/app/app.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Router, NavigationEnd, Location } from '@angular/router';\nimport { AuthService } from './services/auth.service';\nimport { filter } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit {\n  title = 'AI Central';\n\n  constructor(\n    private authService: AuthService,\n    private router: Router,\n    private location: Location\n  ) {}\n\n  ngOnInit(): void {\n    // Handle browser back/forward navigation\n    this.router.events.pipe(\n      filter(event => event instanceof NavigationEnd)\n    ).subscribe((event: any) => {\n      if (event instanceof NavigationEnd) {\n        this.handleNavigation(event);\n      }\n    });\n\n    // Handle browser back button specifically\n    this.location.onPopState(() => {\n      this.handleBrowserBack();\n    });\n  }\n\n  private handleNavigation(event: NavigationEnd): void {\n    const isLoggedIn = this.isLoggedIn();\n    const currentUrl = event.url;\n\n    // If user is not logged in and trying to access protected routes\n    if (!isLoggedIn && this.isProtectedRoute(currentUrl)) {\n      this.router.navigate(['']);\n      return;\n    }\n\n    // If user is logged in and on login page (root or /login), redirect to dashboard and replace history\n    if (isLoggedIn && (currentUrl === '/' || currentUrl === '/login')) {\n      this.router.navigate(['/dashboard'], { replaceUrl: true });\n      return;\n    }\n\n    // Clear any cached data if user is not logged in\n    if (!isLoggedIn) {\n      this.authService.clearUserData();\n    }\n  }\n\n  private handleBrowserBack(): void {\n    const isLoggedIn = this.isLoggedIn();\n    const currentUrl = this.router.url;\n\n    // If user is logged in and trying to go back to login page, prevent it\n    if (isLoggedIn && (currentUrl === '/' || currentUrl === '/login')) {\n      // Replace the current history entry with dashboard\n      this.router.navigate(['/dashboard'], { replaceUrl: true });\n      return;\n    }\n\n    // If user is not logged in and trying to access protected routes, redirect to login\n    if (!isLoggedIn && this.isProtectedRoute(currentUrl)) {\n      this.router.navigate(['']);\n      return;\n    }\n  }\n\n  private isProtectedRoute(url: string): boolean {\n    const protectedRoutes = ['/dashboard', '/user-list', '/user-create', '/user-edit', '/user-view', '/profile', '/change-password'];\n    return protectedRoutes.some(route => url.startsWith(route));\n  }\n\n  isLoggedIn(): boolean {\n    return this.authService.isLoggedIn();\n  }\n\n  isOnLandingPage(): boolean {\n    return this.router.url === '/' || this.router.url === '/login';\n  }\n\n  logout(): void {\n    const userData = this.authService.getUserData();\n    if (userData) {\n      this.authService.logout(userData.username).subscribe({\n        next: () => {\n          this.authService.clearUserData();\n          this.router.navigate(['']);\n        },\n        error: () => {\n          this.authService.clearUserData();\n          this.router.navigate(['']);\n        }\n      });\n    } else {\n      this.authService.clearUserData();\n      this.router.navigate(['']);\n    }\n  }\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}